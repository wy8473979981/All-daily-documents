<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>倒计时</title>
		<style type="text/css">
			#btn{
				width: 100px;
				height: 30px;
				line-height: 30px;
				text-align: center;
				border: 1px solid #f66;
				font-size:12px;
			}
		</style>
	</head>
	<body>
		<div id="btn"></div>
		
	</body>
	<script src="js/jquery-1.11.0.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
//	localStorage.clear();
		if(localStorage.getItem("countTime") == null){
			$("#btn").html("点击获取验证码");
		}
		else{
			checkTime();
		}
		
		$("#btn").on("click",function(){
			countDown(100);
		});
		
		function countDown(n){
			if(localStorage.getItem("countTime") == null){
				$("#btn").html("点击获取验证码");
				$("#btn").prop("disabled","disabled");
				var seconds1 = new Date().getTime();
				var endSeconds1 = seconds1 + n*1000;
				console.log(seconds1);
				localStorage.setItem("countTime",endSeconds1);
				checkTime();
			}
			else{
				checkTime();
			}
		}
		function checkTime(){
				$("#btn").prop("disabled","disabled");
				var seconds2 = new Date().getTime();
				var endSeconds2 = localStorage.getItem("countTime");
				var showTime = Math.floor((endSeconds2 - seconds2) / 1000);
				if(showTime == 0){
					$("#btn").html("点击获取验证码");
					$("#btn").prop("disabled","");
					localStorage.removeItem("countTime");
					return;
				}
				else{
					$("#btn").html(showTime + "s后重新获取");
				}
				setTimeout(checkTime,1000);
			}
			
		
		
		
		
	</script>
</html>
