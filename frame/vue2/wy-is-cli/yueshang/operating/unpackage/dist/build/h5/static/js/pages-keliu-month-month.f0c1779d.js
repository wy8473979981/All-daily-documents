(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-keliu-month-month"],{"0d5d":function(e,t,a){var n=a("ec05");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("2442eb20",n,!0,{sourceMap:!1,shadowMode:!1})},"13c6":function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("app-header",[a("app-project-selector",{attrs:{"disabled-all":!0,selected:e.selectedProj},on:{selected:function(t){arguments[0]=t=e.$handleEvent(t),e.onProjectSelected.apply(void 0,arguments)}}}),a("v-uni-view",{staticStyle:{display:"flex"},attrs:{slot:"right"},slot:"right"},[a("app-date-picker",{attrs:{fromDate:e.queryModel.yearAndMonth,fields:"year"},on:{changed:function(t){arguments[0]=t=e.$handleEvent(t),e.onDateChanged.apply(void 0,arguments)}}})],1)],1),a("v-uni-view",{staticClass:"wrapper"},[a("app-section",{attrs:{collapseable:e.collapseable}},[a("v-uni-view",{staticClass:"head-actions_left_view",attrs:{slot:"head-actions_left"},slot:"head-actions_left"},[a("app-filter-chartdialog",{attrs:{title:e.chartsTitle,items:e.items},on:{chartselected:function(t){arguments[0]=t=e.$handleEvent(t),e.onChartSelectedChange.apply(void 0,arguments)}}})],1),a("app-echarts",{attrs:{height:"400rpx",options:e.lineops,canvasId:"keliupro"}})],1)],1),a("v-uni-view",{staticClass:"wrapper",staticStyle:{"margin-top":"12rpx","margin-bottom":"120rpx"}},[a("app-section",{attrs:{title:"月客流排名（单位：万人）"}},[a("v-uni-view",{attrs:{slot:"head-actions"},slot:"head-actions"},[a("v-uni-view",{staticClass:"list-mode"},[a("v-uni-text",{class:"list-mode-item "+("month"===e.table.mode?"active":""),attrs:{"data-value":"month"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onListModeChanged.apply(void 0,arguments)}}},[e._v("当月")]),e._v("｜"),a("v-uni-text",{class:"list-mode-item "+("year"===e.table.mode?"active":""),attrs:{"data-value":"year"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onListModeChanged.apply(void 0,arguments)}}},[e._v("年累计")])],1)],1),a("app-table",{attrs:{fixednum:1,values:e.table.dataList,columns:e.table.columns}})],1)],1),a("v-uni-view",{staticClass:"bottom-bar"},[a("v-uni-view",{staticClass:"bottom-button",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.gotoJiankong.apply(void 0,arguments)}}},[e._v("客流监控")])],1)],1)},l=[]},"14ca":function(e,t,a){"use strict";var n=a("0d5d"),i=a.n(n);i.a},2875:function(e,t,a){"use strict";var n=a("4ea4");a("ac1f"),a("1276"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf3");var i=n(a("1da1")),l=n(a("bbb7")),o=n(a("86dc")),r=n(a("f8fa")),s=n(a("1b7d")),d=n(a("6c6be")),c=n(a("0fa9")),p=n(a("38ee")),u=n(a("5d16")),h=n(a("a635")),f=getApp(),b=[{label:"月份",key:"month",width:"140",align:"left"},{label:"工作日",key:"gzr",sortable:!0,width:"140",align:"right"},{label:"节假日",key:"jjr",sortable:!0,width:"140",align:"right"},{label:"客流密度",key:"stl",sortable:!0,width:"180",align:"right"},{label:"日均客流",key:"rpj",sortable:!0,width:"180",align:"right"},{label:"客流",key:"kl",sortable:!0,width:"140",align:"right"},{label:"同比",unit:"%",key:"tb",width:"130",sortable:!0,align:"right"},{label:"达成率",key:"dcl",width:"130",sortable:!0,align:"right"}],g=[{label:"月份",key:"month",align:"left",width:"150"},{label:"客流",key:"kl",sortable:!0,width:"200",align:"right"},{label:"日均客流",key:"rpj",sortable:!0,width:"180",align:"right"},{label:"同比",unit:"%",key:"tb",width:"200",sortable:!0,align:"right"},{label:"达成率",key:"dcl",width:"200",sortable:!0,align:"right"}],y=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],m=["10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00"],v={data:function(){return{chartsType:"xm",chartsTitle:"项目客流(人)",items:[{title:"项目客流",type:"xm",value:"",unit:"人"},{title:"客流密度",type:"kl",value:"",unit:"人/天/㎡"}],queryModel:{bisProjectId:null,yearAndMonth:null},updateTime:null,collapseable:!0,lineops:{decimals:"paiming",unit:"%",xAxis:{type:"category",boundaryGap:!1,data:y},yAxis:{type:"value",boundaryGap:!1},series:[{type:"line",lineStyle:{color:"#3AABFF"},areaStyle:{color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#CFDFFE"},{offset:1,color:"#FFFFFF"}])}},{type:"line",lineStyle:{color:"#9BB3C6"}}],legend:{data:[]}},table:{mode:"month",columns:b,dataList:[]},pro_currentDay:[],pro_yesterDay:[],stlchart:[],preStlchart:[],monthData:[],yearData:[],selectedProj:{}}},components:{appHeader:o.default,appProjectSelector:r.default,appSection:s.default,appEcharts:d.default,appTable:c.default,appFilterDialog:p.default,appDatePicker:u.default,appFilterChartdialog:h.default},props:{},onLoad:function(e){this.setData({selectedProj:{label:e.projectName,value:e.bisProjectId},"queryModel.bisProjectId":e.bisProjectId,"queryModel.yearAndMonth":e.yearMonth,"queryModel.yearMonth":e.yearAndMonth}),this.queryData()},onShareAppMessage:function(){},methods:{onProjectSelected:function(e){"全部"!==e.detail.label&&(this.setData({"queryModel.bisProjectId":e.detail.value.bisProjectId}),this.queryData())},onDateChanged:function(e){this.setData({"queryModel.yearAndMonth":e.detail.value}),this.queryData()},onListModeChanged:function(e){var t=e.target.dataset.value;this.table.mode!==t&&this.setData({"table.mode":t,"table.columns":"month"===t?b:g,"table.dataList":"month"===t?this.monthData:this.yearData})},gotoJiankong:function(){f.globalData.page.go("../jiankong/jiankong",{bisProjectId:this.queryModel.bisProjectId,projectName:this.selectedProj.label})},queryData:function(){var e=this;f.globalData.request.options({loading:!0}).get("/open/bis-open-report!pfOfMon.action",this.queryModel).then((function(t){for(var a=t.data,n=a.preStlchart,i=a.stlchart,l=a.dataArr,o=a.pro_currentDay,r=a.pro_yesterDay,s=e.queryModel.yearAndMonth.split("-")[0],d=s-1,c=a.pf,p=[],u=[],h=0,f=c.length;h<f;h++){var b=c[h];p.push({month:b[16],gzr:b[10],jjr:b[11],stl:b[12],kl:b[4],tb:b[6],dcl:b[8],rpj:b[18]}),u.push({month:b[16],kl:b[5],tb:b[7],dcl:b[9],rpj:b[18]})}e.setData({monthData:p,yearData:u,"table.dataList":"month"===e.table.mode?p:u,preStlchart:n,stlchart:i,dataArr:l,pro_currentDay:o,pro_yesterDay:r}),"xm"===e.chartsType?e.setData({"lineops.xAxis.data":m,"lineops.legend.data":[{name:"昨天"},{name:"今天"}],"lineops.series[0].data":r,"lineops.series[0].name":"昨天","lineops.series[1].name":"今天","lineops.series[1].data":o}):("string"===typeof n&&(n=[]),"string"===typeof i&&(i=[]),e.setData({"lineops.legend.data":[{name:s+"年"},{name:d+"年"}],"lineops.xAxis.data":y,"lineops.series[0].data":n,"lineops.series[0].name":d+"年","lineops.series[1].name":s+"年","lineops.series[1].data":i}))}))},onChartSelectedChange:function(e){var t=this;return(0,i.default)(l.default.mark((function a(){var n,i,o;return l.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=e.detail.type,i=t.queryModel.yearAndMonth.split("-")[0],o=i-1,t.chartsType=n,"xm"===n?t.setData({"lineops.xAxis.data":m,"lineops.legend.data":[{name:"昨天"},{name:"今天"}],"lineops.series[0].data":t.pro_yesterDay,"lineops.series[0].name":"昨天","lineops.series[1].name":"今天","lineops.series[1].data":t.pro_currentDay}):("string"===typeof t.preStlchart&&t.setData({preStlchart:[]}),"string"===typeof t.stlchart&&t.setData({stlchart:[]}),t.setData({"lineops.xAxis.data":y,"lineops.legend.data":[{name:i+"年"},{name:o+"年"}],"lineops.series[0].data":t.preStlchart,"lineops.series[0].name":i+"年","lineops.series[1].name":o+"年","lineops.series[1].data":t.stlchart}));case 5:case"end":return a.stop()}}),a)})))()}}};t.default=v},"7acc":function(e,t,a){"use strict";a.r(t);var n=a("2875"),i=a.n(n);for(var l in n)"default"!==l&&function(e){a.d(t,e,(function(){return n[e]}))}(l);t["default"]=i.a},"86ef":function(e,t,a){"use strict";a.r(t);var n=a("13c6"),i=a("7acc");for(var l in i)"default"!==l&&function(e){a.d(t,e,(function(){return i[e]}))}(l);a("14ca");var o,r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"429a0b50",null,!1,n["a"],o);t["default"]=s.exports},ec05:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,"/* pages/keliu/month/month.wxss */.wrapper[data-v-429a0b50]{background-color:#fff}\r\n\r\n/* .updata-time {\r\n\tfont-size: 22rpx;\r\n\tline-height: 74rpx;\r\n\ttext-align: center;\r\n\tcolor: #c5c5c5;\r\n} */.list-mode-item[data-v-429a0b50]{font-size:%?28?%}.list-mode-item.active[data-v-429a0b50]{color:#3992ba;font-size:%?32?%;font-weight:700}.bottom-bar[data-v-429a0b50]{position:fixed;bottom:0;z-index:1;width:100%}.bottom-button[data-v-429a0b50]{margin:%?16?% %?50?%;height:%?80?%;line-height:%?80?%;text-align:center;font-weight:500;font-size:%?32?%;color:#fff;background:-webkit-linear-gradient(135deg,#1d5a87,#3992ba);background:linear-gradient(315deg,#1d5a87,#3992ba)}",""]),e.exports=t}}]);